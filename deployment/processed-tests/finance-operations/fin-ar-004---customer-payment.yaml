name: FIN-AR-004 - Customer Payment - Record customer payment and apply to invoice
description: 'Record customer payment and apply to invoice (Module: Finance Operations, Suite: Accounts Receivable)'
starting_url: https://virtuoso-test.crm.dynamics.com
steps:
- click: Accounts receivable
- click: Payments
- click: Customer payment journal
- click: New
- select:
    selector: Name
    option: CustPay
- click: Lines
- click: Enter customer payments
- select:
    selector: Account
    option: CUST-$TIMESTAMP
- write:
    selector: Credit
    text: '5000'
- select:
    selector: Method of payment
    option: Check
- write:
    selector: Payment reference
    text: CHK-98765
- click: Settle transactions
- comment: Look for invoice "$invoiceNumber"
- click: checkbox for invoice
- comment: Assert that "Amount to settle" equals payment amount
- click: OK
- click: Post
- wait: 2
- comment: Assert that journal posts successfully
